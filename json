[
  {
    "tool_name": "writeFileTool",
    "input_args": {
      "file_path": "src/pages/LibraryManagement.tsx",
      "content": "import { useQuery, useMutation } from \"convex/react\";\nimport { api } from \"@/convex/_generated/api\";\nimport AdminSidebar from \"@/components/AdminSidebar\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from \"@/components/ui/select\";\nimport { Plus, Trash2, Edit, Search } from \"lucide-react\";\nimport { useState } from \"react\";\nimport { toast } from \"sonner\";\nimport { motion } from \"framer-motion\";\n\nexport default function LibraryManagement() {\n  const [searchQuery, setSearchQuery] = useState(\"\");\n  const [isAdding, setIsAdding] = useState(false);\n  const [editingId, setEditingId] = useState<string | null>(null);\n  \n  const [formData, setFormData] = useState({\n    title: \"\",\n    subject: \"\",\n    pdf_url: \"\",\n  });\n\n  const allPDFs = useQuery(api.library.getAllLibraryPDFsAdmin);\n  const addPDF = useMutation(api.library.addLibraryPDF);\n  const updatePDF = useMutation(api.library.updateLibraryPDF);\n  const deletePDF = useMutation(api.library.deleteLibraryPDF);\n\n  // These subjects must match exactly with Library.tsx\n  const subjects = [\n    \"Hematology\",\n    \"Biochemistry\",\n    \"Microbiology\",\n    \"Clinical Pathology\",\n    \"Blood Bank\",\n    \"Histopathology\",\n    \"Immunology\",\n    \"Lab Instruments\",\n  ];\n\n  const filteredPDFs = allPDFs?.filter(\n    (pdf: any) =>\n      pdf.status === \"active\" &&\n      pdf.title.toLowerCase().includes(searchQuery.toLowerCase())\n  );\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    \n    if (!formData.title || !formData.subject || !formData.pdf_url) {\n      toast.error(\"Please fill all fields\");\n      return;\n    }\n\n    // Validate Google Drive link format\n    if (!formData.pdf_url.includes(\"drive.google.com\")) {\n      toast.error(\"Please enter a valid Google Drive link\");\n      return;\n    }\n\n    try {\n      if (editingId) {\n        await updatePDF({\n          pdfId: editingId as any,\n          ...formData,\n        });\n        toast.success(\"PDF updated successfully\");\n        setEditingId(null);\n      } else {\n        await addPDF(formData);\n        toast.success(\"PDF added successfully\");\n      }\n      \n      setFormData({ title: \"\", subject: \"\", pdf_url: \"\" });\n      setIsAdding(false);\n    } catch (error) {\n      toast.error(\"Failed to save PDF\");\n    }\n  };\n\n  const handleEdit = (pdf: any) => {\n    setFormData({\n      title: pdf.title,\n      subject: pdf.subject,\n      pdf_url: pdf.pdf_url,\n    });\n    setEditingId(pdf._id);\n    setIsAdding(true);\n  };\n\n  const handleDelete = async (pdfId: string) => {\n    if (!confirm(\"Are you sure you want to delete this PDF?\")) return;\n    \n    try {\n      await deletePDF({ pdfId: pdfId as any });\n      toast.success(\"PDF deleted successfully\");\n    } catch (error) {\n      toast.error(\"Failed to delete PDF\");\n    }\n  };\n\n  const handleCancel = () => {\n    setIsAdding(false);\n    setEditingId(null);\n    setFormData({ title: \"\", subject: \"\", pdf_url: \"\" });\n  };\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-gray-900 via-gray-800 to-gray-900\">\n      <AdminSidebar />\n      \n      <div className=\"md:ml-64 p-6 md:p-8\">\n        <motion.div\n          initial={{ opacity: 0, y: -20 }}\n          animate={{ opacity: 1, y: 0 }}\n          className=\"mb-8\"\n        >\n          <h1 className=\"text-3xl md:text-4xl font-bold text-white mb-2\">\n            üìö Library Management\n          </h1>\n          <p className=\"text-white/70\">Add PDFs by selecting subject and pasting Google Drive link</p>\n        </motion.div>\n\n        {/* Add/Edit Form */}\n        {isAdding && (\n          <motion.div\n            initial={{ opacity: 0, scale: 0.95 }}\n            animate={{ opacity: 1, scale: 1 }}\n            className=\"mb-6\"\n          >\n            <Card className=\"glass-card border-white/20 bg-white/10\">\n              <CardHeader>\n                <CardTitle className=\"text-white\">\n                  {editingId ? \"Edit PDF\" : \"Add New PDF\"}\n                </CardTitle>\n              </CardHeader>\n              <CardContent>\n                <form onSubmit={handleSubmit} className=\"space-y-4\">\n                  <div>\n                    <Label htmlFor=\"title\" className=\"text-white\">\n                      PDF Title *\n                    </Label>\n                    <Input\n                      id=\"title\"\n                      value={formData.title}\n                      onChange={(e) =>\n                        setFormData({ ...formData, title: e.target.value })\n                      }\n                      placeholder=\"e.g., Blood Cell Morphology Notes\"\n                      className=\"bg-white/10 border-white/20 text-white\"\n                      required\n                    />\n                  </div>\n\n                  <div>\n                    <Label htmlFor=\"subject\" className=\"text-white\">\n                      Select Subject *\n                    </Label>\n                    <Select\n                      value={formData.subject}\n                      onValueChange={(value) =>\n                        setFormData({ ...formData, subject: value })\n                      }\n                      required\n                    >\n                      <SelectTrigger className=\"bg-white/10 border-white/20 text-white\">\n                        <SelectValue placeholder=\"Choose a subject\" />\n                      </SelectTrigger>\n                      <SelectContent>\n                        {subjects.map((subject) => (\n                          <SelectItem key={subject} value={subject}>\n                            {subject}\n                          </SelectItem>\n                        ))}\n                      </SelectContent>\n                    </Select>\n                  </div>\n\n                  <div>\n                    <Label htmlFor=\"pdf_url\" className=\"text-white\">\n                      Google Drive Link *\n                    </Label>\n                    <Input\n                      id=\"pdf_url\"\n                      value={formData.pdf_url}\n                      onChange={(e) =>\n                        setFormData({ ...formData, pdf_url: e.target.value })\n                      }\n                      placeholder=\"https://drive.google.com/file/d/YOUR_FILE_ID/preview\"\n                      className=\"bg-white/10 border-white/20 text-white\"\n                      required\n                    />\n                    <p className=\"text-white/60 text-xs mt-2\">\n                      üìå <strong>Important:</strong> Use Google Drive <strong>preview</strong> link format\n                      <br />\n                      <span className=\"text-yellow-300\">‚ö†Ô∏è Make sure file is set to \"Anyone with the link can view\"</span>\n                    </p>\n                  </div>\n\n                  <div className=\"flex gap-3\">\n                    <Button\n                      type=\"submit\"\n                      className=\"bg-gradient-to-r from-blue-500 to-purple-600 hover:from-blue-600 hover:to-purple-700\"\n                    >\n                      {editingId ? \"Update PDF\" : \"Add PDF\"}\n                    </Button>\n                    <Button\n                      type=\"button\"\n                      onClick={handleCancel}\n                      variant=\"outline\"\n                      className=\"border-white/20 text-white hover:bg-white/10\"\n                    >\n                      Cancel\n                    </Button>\n                  </div>\n                </form>\n              </CardContent>\n            </Card>\n          </motion.div>\n        )}\n\n        {/* Add Button */}\n        {!isAdding && (\n          <motion.div\n            initial={{ opacity: 0 }}\n            animate={{ opacity: 1 }}\n            className=\"mb-6\"\n          >\n            <Button\n              onClick={() => setIsAdding(true)}\n              className=\"bg-gradient-to-r from-green-500 to-emerald-600 hover:from-green-600 hover:to-emerald-700\"\n            >\n              <Plus className=\"h-5 w-5 mr-2\" />\n              Add New PDF\n            </Button>\n          </motion.div>\n        )}\n\n        {/* Search Bar */}\n        <motion.div\n          initial={{ opacity: 0, y: 20 }}\n          animate={{ opacity: 1, y: 0 }}\n          className=\"mb-6\"\n        >\n          <div className=\"relative\">\n            <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-white/60\" />\n            <Input\n              type=\"text\"\n              placeholder=\"Search PDFs...\"\n              value={searchQuery}\n              onChange={(e) => setSearchQuery(e.target.value)}\n              className=\"pl-10 bg-white/10 border-white/20 text-white placeholder:text-white/60\"\n            />\n          </div>\n        </motion.div>\n\n        {/* PDFs List */}\n        <motion.div\n          initial={{ opacity: 0 }}\n          animate={{ opacity: 1 }}\n          className=\"space-y-4\"\n        >\n          <Card className=\"glass-card border-white/20 bg-white/10\">\n            <CardHeader>\n              <CardTitle className=\"text-white\">\n                All PDFs ({filteredPDFs?.length || 0})\n              </CardTitle>\n            </CardHeader>\n            <CardContent>\n              {!filteredPDFs || filteredPDFs.length === 0 ? (\n                <p className=\"text-white/70 text-center py-8\">\n                  No PDFs found. Add your first PDF!\n                </p>\n              ) : (\n                <div className=\"space-y-3\">\n                  {filteredPDFs.map((pdf: any) => (\n                    <div\n                      key={pdf._id}\n                      className=\"flex flex-col md:flex-row md:items-center justify-between gap-4 p-4 rounded-lg bg-white/5 hover:bg-white/10 transition-all\"\n                    >\n                      <div className=\"flex-1 min-w-0\">\n                        <h3 className=\"text-white font-medium truncate\">\n                          {pdf.title}\n                        </h3>\n                        <p className=\"text-white/70 text-sm\">{pdf.subject}</p>\n                        <p className=\"text-white/50 text-xs truncate mt-1\">\n                          {pdf.pdf_url}\n                        </p>\n                      </div>\n                      <div className=\"flex gap-2 flex-shrink-0\">\n                        <Button\n                          onClick={() => handleEdit(pdf)}\n                          size=\"sm\"\n                          variant=\"outline\"\n                          className=\"border-white/20 text-white hover:bg-white/10\"\n                        >\n                          <Edit className=\"h-4 w-4\" />\n                        </Button>\n                        <Button\n                          onClick={() => handleDelete(pdf._id)}\n                          size=\"sm\"\n                          variant=\"destructive\"\n                        >\n                          <Trash2 className=\"h-4 w-4\" />\n                        </Button>\n                      </div>\n                    </div>\n                  ))}\n                </div>\n              )}\n            </CardContent>\n          </Card>\n        </motion.div>\n      </div>\n    </div>\n  );\n}\n"
    }
  },
  {
    "tool_name": "executeCommandTool",
    "input_args": {
      "command": "npx convex dev --once && npx tsc -b --noEmit"
    }
  }
]
